import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.Cd_vQiNd.js";const y="audio-playback-speed";function T({slug:d,lang:c="en"}){const a=n.useRef(null),[i,u]=n.useState(!1),[p,h]=n.useState(0),[m,b]=n.useState(0),[r,x]=n.useState(1),[f,v]=n.useState(null),l=c==="zh-hant"?`/podcasts/${d}.zh-hant.mp3`:`/podcasts/${d}.mp3`;n.useEffect(()=>{(async()=>{try{const s=await fetch(l,{method:"HEAD"});v(s.ok)}catch{v(!1)}})()},[l]),n.useEffect(()=>{const t=localStorage.getItem(y);if(t){const s=parseFloat(t);!isNaN(s)&&s>=.25&&s<=2&&x(s)}},[]),n.useEffect(()=>{a.current&&(a.current.playbackRate=r)},[r]),n.useEffect(()=>{const t=a.current;if(!t)return;const s=()=>h(t.currentTime),o=()=>u(!1),g=()=>{b(t.duration),t.playbackRate=r};return t.addEventListener("timeupdate",s),t.addEventListener("loadedmetadata",g),t.addEventListener("ended",o),()=>{t.removeEventListener("timeupdate",s),t.removeEventListener("loadedmetadata",g),t.removeEventListener("ended",o)}},[r]);const k=()=>{a.current&&(i?a.current.pause():a.current.play(),u(!i))},E=t=>{const s=parseFloat(t.target.value);h(s),a.current&&(a.current.currentTime=s)},N=t=>{const s=parseFloat(t.target.value);x(s),localStorage.setItem(y,s.toString()),a.current&&(a.current.playbackRate=s)},j=t=>{if(isNaN(t))return"0:00";const s=Math.floor(t/60),o=Math.floor(t%60);return`${s}:${o.toString().padStart(2,"0")}`};return f===null||!f?null:e.jsx("div",{className:"mb-6 rounded-lg border border-skin-line bg-skin-card p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{"aria-hidden":!0,className:"text-2xl",children:"üéß"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"m-0 text-base font-semibold text-skin-accent",children:c==="zh-hant"?"Èü≥Ë®äÁâàÊú¨":"Audio Version"}),e.jsx("p",{className:"mt-1 text-xs opacity-70",children:c==="zh-hant"?"Áî± Kokoro TTS ÁîüÊàê":"Generated by Kokoro TTS"}),e.jsx("audio",{ref:a,src:l,preload:"metadata"}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:k,className:"flex h-10 w-10 items-center justify-center rounded-full bg-skin-accent text-white hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-skin-accent focus:ring-offset-2","aria-label":i?"Pause":"Play",children:i?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"h-5 w-5",children:e.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"h-5 w-5",children:e.jsx("path",{d:"M8 5v14l11-7z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"range",min:"0",max:m||0,value:p,onChange:E,className:"w-full",style:{accentColor:"var(--color-accent)"}}),e.jsxs("div",{className:"mt-1 flex justify-between text-xs opacity-70",children:[e.jsx("span",{children:j(p)}),e.jsx("span",{children:j(m)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"playback-speed",className:"text-sm opacity-80 whitespace-nowrap",children:c==="zh-hant"?"Êí≠ÊîæÈÄüÂ∫¶":"Speed"}),e.jsxs("select",{id:"playback-speed",value:r,onChange:N,className:"rounded-md border border-skin-line bg-skin-fill px-2 py-1 text-sm focus:border-skin-accent focus:outline-none focus:ring-1 focus:ring-skin-accent",children:[e.jsx("option",{value:"0.5",children:"0.5√ó"}),e.jsx("option",{value:"0.75",children:"0.75√ó"}),e.jsx("option",{value:"1.0",children:"1.0√ó"}),e.jsx("option",{value:"1.25",children:"1.25√ó"}),e.jsx("option",{value:"1.5",children:"1.5√ó"}),e.jsx("option",{value:"1.75",children:"1.75√ó"}),e.jsx("option",{value:"2.0",children:"2.0√ó"})]})]})]})]})]})})}export{T as default};
